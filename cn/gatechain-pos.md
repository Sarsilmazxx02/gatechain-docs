## PoS挖矿

GateChain的用户有两种方式参与POS挖矿，下面分别介绍一下这两种方式的具体流程。

1. 搭建GateChain全节点，成为共识账户。
2. 委托GT给其他共识账户。

### 搭建GateChain全节点，成为共识账户
搭建节点参与共识，除了能够获得PoS挖矿的收益，还可以接受普通或保险账户的委托，获得委托手续费的收益。

1. 准备一台性能良好的linux或者mac，按照[部署文档](./gatechain-build.md)，安装好最新的GateChain的二进制文件gated，并正确启动。
2. 在节点创建一个普通账户，共识账户上线时不需要太多余额，能够支付上线交易的手续费(0.01GT)即可，共识账户参与共识的最小金额是1GT(10e9 NANOGT)，所以账户的余额+被委托的金额需≥1GT。

  	a.创建普通账户 [CLI](/cli/account.md#生成单签账户)
  	
  	b.发送交易 [CLI](/cli/tx.md#发送交易-api) [API](/API/tx.md#普通交易)
  	
3. 基于普通账户创建一个共识账户。

 	a.创建共识账户 [CLI](/cli/con-account.md#创建共识账户)
 	
4. 在本节点发起“共识账户上线交易”，交易成功后，此普通账户即成为共识账户。

 	a.共识账户上线交易 [CLI](/cli/con-account.md#上线共识账户)
5. 此共识账户和节点就会参与GateChain的共识过程，请保证自己的机器正常运转，网络正常连接。

6. 共识账户每次入选共识委员会，都会获得当前区块的挖矿收益和交易手续费收益。

 	a.查询共识账户的挖矿及手续费收益 [CLI](/cli/distribution.md#查询共识账户的收益-api) [API](/API/distribution.md#查询共识账户的收益-命令行)
 	
7. 作为共识账户，可以接收其他普通或保险账户的委托。
 	
 	a.接受委托之后，共识账户的投票权重会加大，提高入选共识委员会的几率。
 	
 	b.共识账户在获得挖矿收益和交易手续费收益的同时，可以收取委托账户的“委托手续费”。手续费率可以在发起“共识账户上线交易”的时候指定。
 	
 	c.如果要查询委托相关的信息，请使用如下接口：
 	
 	 * 查询共识账户的委托记录 [CLI](/cli/staking.md#查询指定共识账户所有的委托-api)  [API](/API/staking.md#查询指定共识账户所有的委托-命令行)
 	 
 	 * 查询共识账户的转移委托记录 [CLI](/cli/staking.md#查询指定共识账户所有转移委托的记录-api) [API](/API/staking.md#查询转移委托记录-命令行)
 	 
 	 * 查询共识账户的解除委托记录 [CLI](/cli/staking.md#查询指定共识账户所有已解除的委托-api) [API](/API/staking.md#查询指定共识账户所有已解除的委托-命令行)
 	 
 	 * 查询共识账户仍未支付的委托收益 [CLI](/cli/distribution.md#查询共识账户仍未支付的委托收益-api) [API](/API/distribution.md#查询共识账户仍未支付的委托收益-命令行)


### 委托GT给共识账户

如果普通账户不想搭建节点，成为共识账户来参与挖矿，可以选择将自己的GT委托给其他共识账户，来获得挖矿收益。委托功能可在CLI、API、桌面钱包、APP钱包、Web钱包操作。

* 说明：账户没有最低委托限制，但是如果太低中签率会比较低，如果太高收益率会下降，建议搭建更多节点。
* 推荐：所有账户类型均可对共识账户发起委托，**推荐使用保险账户进行委托，保障资金安全。**
* 保险账户发起的委托、转移委托、解除委托、提取收益的交易规则都与普通账户完全一致，包括：委托代币即时生效，在下一个块开始计算收益；转移委托、解除委托仍有21天冻结期；提取收益即时到账；**另外，保险账户要发起清算交易时，必须保证此账户没有任何进行中的委托和冻结中的资金，否则清算失败。**因为委托并不会影响账户中的资金安全，所以保险账户到达清算高度后仍可以发起委托类的四种交易。以下是账户委托的具体说明：

1. 首先选择一个共识账户作为委托对象。

 	a.可以通过查看共识账户的手续费、持仓、收益率等来选择。
 	
 	b.可以通过区块链浏览器来查看：https://gatescan.org/consensus
 	
2. 发起“委托交易”，将自己的部分或者全部GT，委托给某一个/多个共识账户，成为委托人。

 	 a.发起委托交易 [CLI](/cli/staking.md#委托代币到共识账户-api) [API](/API/staking.md#委托代币到共识账户-命令行)
 	 
3. “委托交易”成功后，委托账户能够跟随共识账户的挖矿过程，获得收益。

4. 委托过程中，委托人可以发起“提取收益”、“转移委托”、“解除委托”三种操作。

	注意：委托人操作“再次委托” “转移委托” “解除委托”三种操作时，收益会自动提取到账户余额中，查询具体收益金额需在对应交易详情中查看该字段内容“transfer”。

    a.委托人可以在任意时间，发起“提取收益交易”，将自己的挖矿收益提取到自己的账户余额中。
    
 	 * 查询所有委托信息 [CLI](/cli/staking.md#查询委托账户在所有共识账户的委托信息-api) [API](/API/staking.md#查询委托账户在所有共识账户的委托信息-命令行)
 	 
 	 * 查询所有委托交易 [API](/API/staking.md#查询委托账户的委托交易列表)
 	 
 	 * 设置提取委托收益的账户 [CLI](/cli/distribution.md#设置提取委托收益的账户-api) [API](/API/distribution.md#设置提取委托收益的账户-命令行)
 	 
 	 * 查询委托收益 [CLI](/cli/distribution.md#查询委托账户的委托收益-api) [API](/API/distribution.md#查询委托账户的委托收益-命令行)
 	 
 	 * 提取部分收益 [CLI](/cli/distribution.md#委托账户从单个共识账户提取部分收益-api) [API](/API/distribution.md#委托账户从单个共识账户提取部分收益-命令行)
 	 
 	 * 提取全部收益 [CLI](/cli/distribution.md#委托账户从共识账户提取全部收益-api) [API](/API/distribution.md#委托账户从共识账户提取全部收益-命令行)

   b.委托人可以对一笔委托，发起“转移委托交易”，将GT转到另一个共识账户进行委托。
  
 	 * 注意：委托账户发送转移委托交易之后，在原共识账户处的收益会立即结算。但是在目标共识账户，需要等到21天之后才能发起与目标共识账户有关的转移委托交易，期间收益不受影响。
 	 
 	 * 发起转移委托交易 [CLI](/cli/staking.md#转移委托-api)  [API](/API/staking.md#转移委托-命令行)
 	 
 	 * 查询委托账户所有的转移委托记录 [CLI](/cli/staking.md#查询转移委托记录-api) [API](/API/staking.md#查询转移委托记录-命令行)
 	 
 	 * 查询委托账户在两个共识账户之间的转移委托记录 [CLI](/cli/staking.md#查询委托账户在两个共识账户之间的转移委托记录) [API](/API/staking.md#查询转移委托记录-命令行)
 	 
   c.委托人可以从一个共识账户，进行部分或者全部“解除委托”。
 	
 	 * 注意：一笔解除委托发起之后，在原共识账户处的收益会立即结算，本金需要等到21天后，才会提取到自己的账户余额中。
 	 
 	 * 发起解除委托交易 [CLI](/cli/staking.md#从共识账户解绑-api) [API](/API/staking.md#从共识账户解绑-命令行)
 	 
 	 * 查询委托账户在单个共识账户已解除的委托记录 [CLI](/cli/staking.md#查询委托账户在单个共识账户已解除的委托记录-api) [API](/API/staking.md#查询委托账户在单个共识账户已解除的委托记录-命令行)
 	 
 	 * 查询委托账户在所有共识账户已经解除的委托记录 [CLI](/cli/staking.md#查询委托账户在所有共识账户已经解除的委托记录-api)
 [API](/API/staking.md#查询委托账户在所有共识账户已经解除的委托记录-命令行)

 	 * 查询指定共识账户所有已解除的委托 [CLI](/cli/staking.md#查询指定共识账户所有已解除的委托-api) [API](/API/staking.md#查询指定共识账户所有已解除的委托-命令行)

 	 
### 共识账户及委托账户的收益分配说明

每轮区块的总收益是0.4GT+交易手续费，根据入选委员会的共识账户权值反比分配（权值越低获得收益越高，反之成立），权值 =（持币量+被委托GT量）*忠诚系数。

1. 共识账户的收益分配规则，一共分为三种情况：

	a.本轮区块委员会三个共识账户入选，按照每个账户的权值占比，如果在40%-27%之间就按实际比例分配，如果超出40%或低于27%，都按保底分配：40%、33%、27%；

	b.本轮区块委员会两个共识账户入选，按照每个账户的权值占比，如果在60%-40%之间就按实际比例分配，如果超出60%或低于40%，都按保底分配：60%、40%；
	
	c.本轮区块委员会一个共识账户入选，则获得100%收益。
	
2. 共识账户与委托账户按照持币比例分配应得收益，例：该共识账户应得40%的收益即0.16GT，共识账户持币量10000GT，委托账户委托量10000GT，0.16*50%=0.08，所以共识账户和委托账户各得0.08GT（委托账户需按照手续费率支付一定费用给共识账户）。



